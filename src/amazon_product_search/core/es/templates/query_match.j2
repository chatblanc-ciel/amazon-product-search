{
    "function_score": {
        "query": {
            "dis_max": {
                "queries": [
                    {% for query in queries %}
                    {
                        "multi_match": {
                            "query": "{{ query }}",
                            "type": "cross_fields",
                            "fields": {{ fields | tojson }},
                            "operator": "and",
                            "boost": 1.0
                        }
                    }
                    {% if not loop.last %}
                    ,
                    {% endif %}
                    {% endfor %}
                ]
            }
        },
        "functions": [
            {% if enable_phrase_match_boost %}
            {
                "filter": {
                    "match_phrase": {
                        "product_title": {
                            "query": "{{ queries[0] }}",
                            "boost": 2
                        }
                    }
                }
            }
            {% endif %}
        ]
    }
}
